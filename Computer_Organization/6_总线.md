# 总线
## 总线概述
-------------------
### 总线的基本概念
- 总线的定义
  - 总线是一组能为多个部件分时共享的公共信息传送线路
  - 分时: 同一时刻只允许有一个部件向总线发送信息
  - 共享: 总线上可以挂接多个部件,各个部件之间互相交换的信息可以通过这组线路分时共享
- 总线设备
  - 主设备: 总线的主设备是指获得总线控制权的设备
  - 从设备: 总线的从设备是指被主设备访问的设备,只能相应从主设备发来的各种总线命令
- 总线特性
  - 机械特性: 尺寸形状
  - 电气特性: 传输方向和有效的电平范围
  - 功能特性: 每根传输线的功能
  - 时间特性: 信号和时序的关系
- 总线的猝发传输
  - 一个总线周期内传输存储地址连续的多个数据字的总线传输方式,称为猝发传输
### 总线的分类
- 片内总线
  - 芯片内部的总线,是CPU芯片内部寄存器与寄存器之间,寄存器与ALU之间的公共连接线
- 系统总线
  - ：各个功能部件之间相互连接的总线
  - 数据总线
    - 传输各功能部件之间的数据信息
    - 双向传输总线
    - 位数与机器字长、存储字长有关
  - 地址总线
    - ：数据总线上的源数据或目的数据所在的主存单元或I/O端口的地址
    - 单向传输总线地址
    - 总线的位数与主存地址空间的大小有关
  - 控制总线
    - 传输控制信息
    - CPU送出的控制命令和主存返回CPU的反馈信号
- 通信总线
  - 计算机系统之间或计算机系统与其他系统之间传送信息的总线,也被称为外部总线
### 系统总线的结构
- 单总线结构
  - 将CPU、主存、I/O设备都挂载到一组总线上
    - 优点: 结构简单成本低容易接入新设备
    - 缺点: 带宽低负载重多个部件只能争用唯一的总线,并且不支持并发传送操作
- 双总线结构
  - 一条是主存总线,用于CPU、主存和通道之间传送数据,另一条是I/O总线用于在多个外部设备和通道之间传送数据
    - 优点: 将低速/O设备从单总线上分离出来,实现了存储总线和/O总线分离
    - 缺点: 需要增加通道等硬件设备
- 三总线结构
  - 计算机系统各部件之间采用三条独立总线来构成信息通路(主存总线I/O总线直接内存访问(DMA)总线
    - 优点: 提高了I/O设备的性能,使其更快的响应命令,提高系统的吞吐量
    - 缺点: 系统工作效率较低
### 总线的性能指标
1. 总线的传输周期:  一次总线操作所需要的时间(申请阶段,寻址阶段,传输阶段和结束阶段),总线传输周期由若干个总线时钟周期构成
2. 总线时钟周期:  即机器的时钟周期
3. 总线的工作频率:  总线周期的倒数
4. 总线的时钟频率:  时钟周期的倒数
5. 总线带宽:  单位时间内总线可以传输的数据位数
6. 总线复用:  一种信号线在不同时间传输不同的信息,节约了空间和成本
7. 信号线数:  地址总线、数据总线、控制总线,三种总线数的总和称为信号线数总线带宽:总线本身的最大传输率,是衡量性能的重要指标
-------
## 总线仲裁
### 集中仲裁方式
- 链式查询方式
  - 根总线请求线一根总线忙线一根总线允许线
    - 优点: 优先级固定结构简单扩充容易
    - 缺点: 对于电路故障敏感优先级不可变
- 计数器定时查询方式
  - 使用计数器控制总线使用权
    - 优点: 设备优先级相等优先次序可以改变
    - 缺点：增加了控制线数控制较为复杂
- 独立请求方式
  - 每个设备均有请求线与总线允许线
    - 优点: 响应速度快优先次序控制灵活
    - 缺点: 控制线数多总线控制逻辑更复杂
### 分布仲裁方式
- 不需要中央仲裁器,每个潜在主模块,都有自己的仲裁号和仲裁器,然后进行仲裁号比较,获胜者仲裁号保留在仲裁总线上
--------
## 总线操作和定时
### 总线传输的4阶段
1. 申请分配阶段: 设备提出申请
2. 寻址阶段: 获得使用权的主设备,发岀要访问模块的地址以及相关命令,启动本次传输的从模块
3. 传输阶段: 主模块与从模块,进行双向或者单向数据传送
4. 结束阶段: 主模块有关信息均从系统总线上撤除,让岀总线使用权
### 同步定时方法
- 系统采用一个统一的时钟信号来协调发送和接收双方的传送定时关系
  - 优点: 传送速度快拥有较高的传输速率总线控制逻辑简单
  - 缺点: 主从设备属于强制性同步不能及时进行数据通信的有效性检验可靠性较差
### 异步定时方法
- 没有统一的时钟,完全按照传送双方相互制约的握手信号实现定时控制
  - 优点:总线周期长度可变可以保证两个速度相差较大部件或设备的信息传输
  - 缺点:控制相对复杂并且速度相对较慢
--------
## 总线标准

### 常见总线标准
- 系统总线
  - ISA:最早出现的微型计算机总线
  - EISA:ISA的扩展形式
- 局部总线
  - VESA针对系统高速传送活动图像的大量数据的局部总线
  - PCI:为外围设备使用的总线即插即用桥连接
  - PCI- Express:最新的总线和接口标准用于代替PC和AGP 
  - AGP:视频接口标准用于连接主存和图型存储器
- 设备总线
  - RS-232C:应用于串行二进制交换的数据终端设备(DTE)和数据通信设备(DCE)
  - **USB**
- PCMCIA:用于扩展功能的小型插槽即插即用
- IDE:集成设备电路,又称ATA,是一种IDE接口磁盘驱动器接口类型
- SCSI:用于计算机和智能设备之间系统级接口的独立处理器标准,是一种智能的通用接口标准
- **SATA**:是一种基于行业标准的串行硬件驱动器接口
